{% extends "base.html" %}

{% block title %}Send Bulk Emails - Email Receipts{% endblock %}

{% block extra_css %}
<style>
    .form-container {
        max-width: 600px;
        margin: 0 auto;
    }
    
    .upload-area {
        border: 2px dashed #3e1c68;
        border-radius: 10px;
        padding: 40px;
        text-align: center;
        margin: 30px 0;
        transition: all 0.3s;
        cursor: pointer;
        user-select: none;
    }
    
    .upload-area * {
        pointer-events: none;
    }
    
    .upload-area:hover {
        border-color: #764ba2;
        background: #f8f9fa;
    }
    
    .upload-icon {
        font-size: 48px;
        margin-bottom: 20px;
    }
    
    .file-input {
        display: none;
    }
    
    .btn {
        background: linear-gradient(135deg, #3e1c68 0%, #764ba2 100%);
        color: white;
        padding: 12px 30px;
        border: none;
        border-radius: 5px;
        font-size: 16px;
        cursor: pointer;
        transition: transform 0.2s;
        width: 100%;
    }
    
    .btn:hover {
        transform: translateY(-2px);
    }
    
    .btn:disabled {
        background: #ccc;
        cursor: not-allowed;
        transform: none;
    }
    
    .file-name {
        margin-top: 20px;
        padding: 10px;
        background: #f8f9fa;
        border-radius: 5px;
        display: none;
    }
    
    .csv-format {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 10px;
        margin-top: 30px;
    }
    
    .csv-format h3 {
        color: #3e1c68;
        margin-bottom: 15px;
    }
    
    .csv-format code {
        display: block;
        background: white;
        padding: 15px;
        border-radius: 5px;
        overflow-x: auto;
        font-size: 12px;
    }
    
    .download-template {
        display: inline-block;
        margin-top: 15px;
        color: #3e1c68;
        text-decoration: none;
        font-weight: 500;
    }
    
    .download-template:hover {
        text-decoration: underline;
    }
</style>
{% endblock %}

{% block content %}
<div class="form-container">
    <h2>Send Bulk Email Receipts</h2>
    <p style="color: #666; margin-bottom: 30px;">Upload a CSV file to send receipts to multiple customers</p>
    
    <form method="POST" action="{{ url_for('send_bulk') }}" enctype="multipart/form-data" id="bulkForm">
        <input type="hidden" name="_csrf_token" value="{{ csrf_token() }}">
        <div class="upload-area" id="uploadArea">
            <div class="upload-icon">üìÅ</div>
            <h3>Click to Upload CSV File</h3>
            <p style="color: #666; margin-top: 10px;">or drag and drop your file here</p>
            <input type="file" id="csv_file" name="csv_file" class="file-input" accept=".csv" required>
        </div>
        
        <div class="file-name" id="fileName"></div>
        
        <button type="submit" class="btn" id="submitBtn" disabled>Send Bulk Emails</button>
    </form>
    
    <div class="csv-format">
        <h3>üìã CSV File Format</h3>
        <p style="margin-bottom: 15px;">Your CSV file should have the following columns:</p>
        <code>
            email,name,purchase_date,edition,link,username,password<br>
            john@example.com,John Doe,2025-01-15,print,,,<br>
            jane@example.com,Jane Smith,2025-01-14,digital,https://example.com/access,janesmith,pass123
        </code>
        
        <p style="margin-top: 15px; color: #666;">
            <strong>Required columns:</strong>
        </p>
        <ul style="margin-left: 20px;">
            <li><strong>email</strong> - Customer's email address</li>
            <li><strong>name</strong> - Customer's full name</li>
            <li><strong>purchase_date</strong> - Date of purchase (YYYY-MM-DD format)</li>
            <li><strong>edition</strong> - Either "digital" or "print"</li>
        </ul>
        
        <p style="margin-top: 15px; color: #666;">
            <strong>Digital edition columns (required only if edition=digital):</strong>
        </p>
        <ul style="margin-left: 20px;">
            <li><strong>link</strong> - URL for digital access</li>
            <li><strong>username</strong> - Login username</li>
            <li><strong>password</strong> - Login password</li>
        </ul>
        
        <p style="margin-top: 15px; color: #856404; background: #fff3cd; padding: 10px; border-radius: 5px;">
            <strong>Note:</strong> For print editions, leave link, username, and password columns empty.
        </p>
    </div>
</div>

<script src="{{ url_for('static', filename='js/bulk_upload.js') }}"></script>
{% endblock %}
